package jdbc;
import java.sql.*;
import java.util.*;
public class Demo_8 {

	public static void main(String[] args) {
	

			public static void main(String[] args) throws ClassNotFoundException, SQLException  
			{
				
				char ch;
				Class.forName("com.mysql.cj.jdbc.Driver");
				Connection con=DriverManager.getConnection("jdbc:mysql://localhost:3306/jdbc_con? autoReconnect=true&useSSL=false","root","dipak2305");
				do
				{
				Scanner s=new Scanner(System.in);
				System.err.println("********SELECT OPERATION*******");
				System.out.println("1.CREATE TABLE\n2.INSERT\n3.SHOW");
				System.out.print("Enter your choice:");
				int opt=s.nextInt();
				switch(opt)
				{
				case 1:
					System.out.print("Enter table Name:");
					String tb=s.next();
					Statement pst=con.createStatement();
					pst.execute("create table "+tb+"(id int, movie_name varchar(40))");
					System.out.println("table <"+tb+"> is created...");
					System.out.println("------------------------------------------------------");
					//con.close();
					break;
					
				case 2:
					
					
					System.out.print("Insert into (table_name):-");
					String tb1=s.next();
					System.out.print("enter id and name:-");
					
					int id=s.nextInt();
					
					String nm=s.nextLine();
					
					PreparedStatement pst1=con.prepareStatement("insert into "+tb1+" values(?,?)");
					pst1.setInt(1,id);
					pst1.setString(2, nm);

					pst1.executeUpdate();
					System.out.println("data inserted...");
					//con.close();
					System.out.println("------------------------------------------------------");


					break;
					
				case 3:
					System.out.print("Enter table name:-");
					String tb3=s.next();
					Statement st=con.createStatement();
					ResultSet rs=st.executeQuery("select * from "+tb3+"");
//					if(rs.next())
//					{
					if(rs.next())
					{
						System.out.println(rs.getInt(1)+" "+rs.getString(2));
					}
					//}
					else
					{
						System.err.println("Table is Empty......");
					}
					rs.close();
					//con.close();
					System.out.println("------------------------------------------------------");

					break;
					
				}
				System.out.print("Do you want to countinue y/n: ");
				System.out.print("\n---------------------------------------------------------");
				System.out.println();
				ch=s.next().charAt(0);
				}while(ch!='n');
				//rs.close();
				con.close();
				
				
			}

		}


	}

}
